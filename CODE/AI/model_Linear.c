/*********************************************************************************************************************
 * COPYRIGHT NOTICE
 *
 * @file            DNN
 * @author          Cz
 * @date            2021-4-23
 ********************************************************************************************************************/
//神经网络部分，了解了解就好
#include "headfile.h"
#define Input_Node 8
#define Dense1_Node 64
#define Dense2_Node 16
#define Dense3_Node 8
#define Dense4_Node 1 //即output
double Output=0;
double Input[Input_Node];
double Dense1[Dense1_Node],Dense2[Dense2_Node],Dense3[Dense3_Node],Dense4[Dense4_Node];

float w1[8][64]={
{-0.03528589,-0.3531317,-0.16914104,0.15133168,-0.25091583,0.07985161,-0.2953048,-0.2607483,-0.027470686,0.21830714,0.15035994,-0.5585115,-0.7767946,0.0168871,0.15694143,-1.1107541,-0.057800487,0.039146755,-0.11886907,-1.6930729,0.10123585,0.030211985,-0.020833509,0.1289643,-0.26511845,-0.33794987,0.056314304,-0.04030334,-0.0035854357,0.18889336,0.13320033,-0.1197357,-0.16032228,-1.5111566,-0.2252526,-0.2735874,0.051234275,0.124144204,-0.020522533,0.34345263,-0.0812714,-1.1895082,-0.11908099,-0.007157444,0.009532047,-0.06679552,-0.23441413,0.053551447,-0.28991348,-0.08616312,-0.076345384,0.069821835,-0.11154039,-0.095196426,0.2354942,-0.08515718,0.16971385,-0.17095359,-0.19081096,-0.18608417,-0.050774068,0.045146164,-0.051154085,-1.3014469},
{-0.98908335,0.15143934,-0.035286784,-0.11828862,-0.6726713,0.20975748,0.46499923,-0.3185118,0.29726368,-0.43433064,0.17094731,0.06013085,-0.62767786,-0.42439178,-0.50119007,-0.1906746,0.10914233,-0.5085418,0.48561275,-0.3726959,0.4821292,0.008018732,0.166384,-0.7491858,-0.07566783,0.08664678,0.23338696,0.22593279,-0.38445768,-0.6269587,0.2874835,-0.2307594,-0.43209505,-0.05511148,-0.1701503,-0.06342499,-0.13713206,0.46268675,0.43092284,-0.32237986,0.15342787,-0.5516135,0.5177093,-0.27939862,-0.73098516,-0.68747175,-0.24447772,0.12116566,-0.32008138,-0.22755702,-0.010979384,-0.25198522,-0.067638546,0.08914378,-0.08987589,-0.48987728,-0.06644201,0.14559306,-0.6892983,0.08251551,0.18895781,-0.6439869,-0.13300882,0.09227316},
{-0.29317316,-0.23301789,-0.13384911,0.1306134,0.41114354,-0.025206272,-0.18448317,-0.3787083,-0.15313461,0.30249625,-0.7856984,0.20567058,-0.5474772,-0.5869804,0.20613874,0.47073248,-0.23288435,-0.5324355,-0.19210182,0.19166674,-0.33544675,-0.28533682,0.5850251,0.48946893,0.31029338,0.53327405,-0.48320886,-0.48875508,-0.4916946,-0.68568367,0.42240676,-0.40485668,0.58364475,0.40975878,-0.43177608,-0.14017032,-0.5018529,-0.09069586,-0.5026364,0.38494745,-0.47086564,0.16800858,-0.32606632,0.3623327,-0.4693614,0.51382184,0.26397002,0.29305857,0.21224064,-0.43057436,-0.07363559,-0.27068532,0.4471509,-0.0053092837,-0.712889,-0.5345534,-0.44020823,-0.28024414,-0.17324255,0.39619127,0.39974746,-0.65768856,0.40602916,0.049213436},
{0.29091823,-0.06861898,-0.24043313,0.39366874,-0.14123748,0.28211123,0.25089487,0.3968577,0.3933549,0.015503845,0.07952201,0.033335947,-0.37710696,0.038539056,0.3135375,-0.47670084,0.03126943,0.2883249,-0.0010721528,-0.1836308,-0.24344032,0.032946497,-0.15205163,-0.36069414,-0.053940043,0.19624531,0.07784816,0.35454717,0.37351337,-0.110662356,-0.04448688,0.023878358,-0.20340478,-0.27146286,0.009292689,-0.19241357,0.21514452,-0.5112222,0.27895662,-0.37701064,-0.3640991,0.35300905,0.18418607,-0.19509971,0.16709734,-0.112422794,-0.1526839,0.06857637,0.10424419,0.02401064,-0.17250723,0.0010534525,-0.19694336,0.15473539,-0.12974219,0.22760049,-0.058013394,0.08118429,0.30861527,0.05906222,-0.16849613,-0.015059516,0.14130706,0.021522298},
{0.19121274,0.31187052,-0.07783574,0.0834705,0.21655606,0.21718855,0.3858694,0.028615583,0.37687275,-0.16034311,0.3530511,0.23793158,-0.04003685,0.100750595,-0.13978061,-0.16659768,-0.12497488,-0.30219108,0.39783165,-0.25121245,0.18718308,-0.14989012,-0.0725207,-0.076611556,0.3542941,-0.06839027,0.2087032,0.11398186,-0.011133397,0.103024274,-0.14901187,0.16870603,0.06291802,-0.29981318,0.11321964,0.23931026,0.117312774,-0.31281623,-0.010472236,-0.12049667,-0.04510316,-0.027679773,0.21087983,0.23448296,0.19603823,-0.31089118,-0.10439427,0.23021269,0.3045952,-0.110174924,0.07498768,-0.115263954,0.25134903,-0.27482846,0.03214967,-0.024741719,0.29623652,0.083645605,0.24337266,-0.04074437,-0.33722654,0.011963314,0.10419617,0.30191976},
{-0.3903519,-0.40493882,0.011390269,-0.09778621,0.278289,-0.4145326,-0.31232965,0.26622793,-0.2116042,-0.27548817,-0.2519453,-1.1729511,0.12726247,-0.19542982,0.24630342,0.04604261,-0.056342155,-0.20024198,-0.34117875,-0.19766742,-0.32345292,0.000623703,-0.66888225,0.16940026,0.13327064,0.15440485,-0.23643342,-0.6920298,-0.57519925,-0.042043056,-0.007349023,0.23518984,0.50596875,0.002220344,0.16232939,-0.17209455,-0.6412197,0.2600805,-0.519352,-0.0182936,0.32033753,-0.047306,-0.07354888,0.47324318,-0.36836004,0.2997115,-0.16559693,0.07147495,0.286746,0.20379874,0.1730924,-0.1600414,0.46029392,-0.22511911,0.24176705,-0.087204576,0.050974794,-0.10400457,0.14285398,0.42216378,-0.057332907,0.15483555,0.18145283,-0.7630624},
{0.25101066,-0.35428917,0.26738256,0.18570682,0.039652076,0.26767644,-0.19511512,-0.014570944,-0.114360094,0.52573556,0.17456788,0.26396123,-0.81987405,0.07635394,0.27495238,0.038126074,-0.19953604,0.089583434,0.19958787,-0.26736307,-0.08642935,0.17842457,-0.5741813,0.2100279,-0.246083,-0.31414545,-0.8522588,-0.19015807,-0.06358083,0.04467185,-0.2741345,0.147762,-0.29650277,-0.14222583,-0.011362775,0.11764035,-0.3337804,-0.004113906,-0.40978023,0.16986677,0.084232844,-0.32519546,0.13265504,-0.49603212,0.136463,0.04761967,-0.20533141,-0.17528208,-0.4953055,0.33750305,-0.23477924,-0.22949722,-0.48488626,-0.19970776,-0.6884699,0.040958274,-0.98528683,0.046581246,-0.6389843,-0.59586227,-0.7034519,0.22355662,-0.07277491,0.35326234},
{0.067588754,0.33055222,-0.19970156,-0.60075444,-0.11829186,0.0035720922,0.093758844,-0.30214086,-0.3051081,-0.1363256,0.081469424,0.056530517,0.13405308,0.08656577,-0.49612734,0.31878665,-0.24339703,0.29865935,0.07910837,0.4237598,0.29771432,-0.2105274,-0.4508488,-0.016581565,-0.31925705,-0.16846125,0.14009106,0.084635794,0.21243098,0.21552005,-0.371567,-0.29646337,-0.12337534,0.34504825,-0.32276875,-0.2270098,0.23183857,-0.028560739,0.22397563,0.11736362,-0.047200628,0.11174667,0.10106734,-0.27445346,0.06946034,0.015116623,-0.041268393,-0.02457867,-0.39377755,-0.06974515,-0.22538352,-0.0957239,-0.3521761,-0.27723214,0.32494402,-0.018854754,0.054979824,-0.09648261,-0.20852338,-0.2878211,0.33651784,-0.09046075,-0.1155742,-0.10685645}
};
float b1[64]={
-0.12916915,-0.16301896,0.0,-0.19606413,-0.12562124,-0.29696897,-0.2665342,-0.055666767,-0.26111442,0.049939815,-0.31089625,-0.31122926,0.099025935,0.11751642,-0.14101112,-0.06844147,0.0,0.045782324,-0.23087865,-0.07187434,-0.11801432,0.0,0.07110255,-0.0094424365,-0.0076867663,-0.0043233945,-0.0142784985,0.028955784,0.0028254034,0.014828082,0.023943305,0.15466781,-0.12263438,-0.06259904,0.24888042,0.0,0.005960456,0.12137319,0.028752169,-0.019414311,0.15092139,-0.14647764,-0.14812201,-0.05680689,0.013464597,-0.011908603,0.0,-0.2788509,-0.0384552,0.12101194,0.0,0.0,-0.03245348,0.0,-0.20954987,0.14140148,-0.089256294,-0.013703133,-0.091801345,-0.015807347,-0.06840085,0.113090724,-0.19615439,-0.16380079
};

float w2[64][16]={
{-0.47365928,-0.26006058,-0.8542496,-0.45664912,-0.64685655,-0.04189065,-1.5086848,-0.4338787,-0.030710278,-0.04564338,-0.05991686,-0.058437992,-0.7805687,-0.7542981,0.053417575,-0.6865408},
{0.14064619,-0.19322218,0.09304966,0.08998829,0.79579777,-0.03793757,-1.1899649,-0.42868987,0.5837634,0.28389338,0.20055613,0.17798418,0.3292059,0.14172792,0.32785976,-0.3960812},
{-0.14483698,-0.13335863,-0.2516802,0.07490823,0.029035628,-0.104801744,0.021235704,0.14671397,-0.12443097,0.17096892,0.246405,0.2454372,0.2051009,-0.12293051,-0.25044444,-0.19305724},
{-0.3497184,0.22179845,-0.7790891,-0.7073135,-1.3161,0.20656879,-0.038374625,-0.0041759037,-0.7826863,-0.22409886,-0.3115023,-0.2694232,-0.13601919,-0.5942122,-0.57776916,0.027804675},
{0.1619782,0.5277468,0.16560903,0.24949701,-1.5472708,0.51576596,-0.020013059,0.2795771,-1.6587815,-1.1264318,-0.43531907,-0.5640306,0.34876344,0.27481532,-1.422254,0.21760365},
{-0.7732742,-0.007588979,-0.5359814,-0.36837015,-1.8323188,0.07639802,-0.23158757,-0.041791074,-0.12350006,-0.48968458,-1.2613124,-0.056551106,0.017574914,-0.5068335,-0.87460655,-0.07494259},
{0.0086079445,-0.742828,-0.8664784,-1.2780865,-0.2489409,-0.40484628,-0.7762022,-1.2074325,0.032984577,0.026858805,0.04505119,0.26715386,-0.42006677,-0.55766803,-0.107611425,-1.0589371},
{-0.71296287,0.25674197,-0.13451357,-0.20599486,0.5801044,-0.0481668,0.083942905,-0.037258133,2.022669,0.74741787,1.0418062,2.1803496,0.48540977,-0.049769912,1.224477,-0.33974898},
{-0.76070917,-0.05845259,-0.5002676,-0.59825337,-1.3971523,0.13613643,-0.8217412,-0.21248135,0.06964624,-0.022721559,-1.2359756,-0.010365797,-0.01760236,-0.765137,-1.0257442,-0.32962567},
{-0.23650894,0.007781103,-0.54673475,-0.5008342,-1.0411103,0.025125759,-0.0034460884,-0.01852166,-0.1345325,-0.04251155,-0.20652415,-0.066481024,-0.31075355,-0.8071326,-0.40949348,0.0007890705},
{-0.77938694,-0.756683,-0.19578405,-0.16789119,-1.1642836,-0.059527792,-0.1827031,-0.31170282,-0.47790277,-0.47409147,-1.0367289,-0.07314223,0.0046671247,-0.3238367,-0.94513893,-0.73822},
{-0.25752407,-0.98192334,-0.4620204,-0.043567125,-0.16656332,-0.9176376,-0.4672542,-0.8099518,0.0834234,-0.23308474,-0.65901303,-0.008500225,-0.55204713,-0.2734143,-0.2962181,-1.1877648},
{-0.06980053,-0.14651304,-0.08561967,-0.007890217,0.27345693,0.008210547,-0.11933381,0.05860658,0.8481008,0.4623282,1.0608928,0.95046735,0.13647619,-0.115213685,0.27868786,-0.1516584},
{-0.002977987,-0.6501393,-0.025159828,-0.022442544,0.060354784,-0.3410581,-1.1419759,-1.5388614,0.048389666,0.028194973,0.09273163,0.16760316,0.07681812,-0.046218056,0.07525178,-1.2609777},
{-0.71797043,0.2396127,-0.5704141,-0.5960226,-1.3858476,0.24900335,-0.029455151,-0.052760765,-1.5806704,-0.2966017,-0.6564234,-0.40149423,-0.5006085,-0.6459491,-0.83441454,0.01003491},
{-1.5928065,0.02364176,-1.5561514,-1.0791813,-2.3489714,0.123627946,-0.041911837,-0.035073258,-0.4334649,-0.52192134,-0.64308816,-0.17116268,-1.6230183,-1.5218472,-1.0087031,-0.101400435},
{0.023016661,-0.20466644,-0.13150612,-0.15427877,-0.038879484,-0.20915565,0.1633986,0.19857037,-0.115886256,0.0754689,-0.17958254,0.13074315,0.037225515,-0.19636592,-0.18331099,0.057711452},
{0.0024398142,-1.0122058,-0.017927492,-0.076796584,0.18185812,-0.7228924,-1.0467404,-1.0376366,0.44249424,0.024026345,0.38909245,0.42451787,0.07472124,-0.027834838,0.35739216,-1.14116},
{-0.6867486,0.080938354,-0.008660886,0.15408047,-0.6971145,-1.0308399,-0.6728252,-0.89004105,-0.45883083,-0.5428151,-0.60857326,-0.050247323,0.06368922,-0.06444393,-0.94537705,-1.3122823},
{-1.577352,0.39271533,-1.3556801,-0.8491093,-1.8718075,0.052998953,-0.8166953,-0.61068493,-0.22615114,-0.39439216,-0.43329206,-0.41482565,-1.3235568,-1.2339374,-0.98589736,-0.25426626},
{-0.0095772445,-0.051892024,0.020757249,-0.064928114,0.022536306,-0.09788738,-0.75280833,-0.7586325,0.025496777,-0.08090695,0.51456374,0.029293712,0.017468575,-0.01703686,0.18419732,-0.6069141},
{0.2591887,0.23588288,0.055965245,-0.09433086,-0.061381742,-0.07927814,-0.00012150407,-0.075638875,0.03514391,-0.06573266,-0.18258315,-0.25463644,0.25793546,0.20384517,0.003750205,-0.08580175},
{-0.30829668,1.421567,-0.29175952,-0.24509348,-0.89088887,1.8397663,0.3331396,0.9043594,-0.47116962,-0.25610232,-0.30162805,-0.25301778,-0.15668824,-0.41420388,-0.3262657,-0.005684886},
{-0.4606008,0.57104856,-0.49256822,-0.60640675,-1.6588517,0.64268506,0.10243617,0.009279714,-0.86315036,-0.6115437,-0.33590782,-0.4105661,-0.4435167,-0.39942047,-0.83862925,0.12022236},
{-0.27474564,-0.020459007,-0.16716385,0.0036247978,-1.5476245,0.060232356,0.019175224,0.016435787,-0.091947734,-0.41943213,-0.00477606,-0.008505,0.040898737,-0.2401555,-0.21145271,0.058484875},
{-0.063093446,0.040426236,0.0071766865,-0.0041185496,-0.973275,0.012075744,0.02389977,0.0024340092,-0.0221415,-0.2455015,-0.004918989,-0.024825504,0.029604023,-0.02197778,-0.11849256,0.0036095544},
{-0.020751024,-0.30563307,-0.05132957,-0.1941332,-0.13044487,-0.096550524,-1.279445,-0.5867184,0.03352396,0.032012444,-0.008352394,0.04507904,-0.033289343,-0.09768729,0.0206202,-0.66374683},
{0.0005585908,-0.45810503,-0.69063514,-1.2217752,-0.010530039,-0.15531479,-2.0750883,-0.78320354,-0.0033235815,0.005533063,0.027955461,0.015979579,-0.3179892,-1.0268618,-0.053328604,-1.0060694},
{0.1371047,-0.27767417,-0.17241998,-0.32745814,-0.05289887,-0.091795444,-2.4097228,-0.65528315,0.017848399,-0.0027276452,0.060196333,-0.03172014,0.42924422,-0.017198822,0.081469,-0.79467565},
{0.0074772085,-0.77802896,-0.061136182,-0.06627811,0.1466262,-0.91821396,-1.144545,-0.9612735,0.14242178,0.15051393,0.12150624,0.5097175,0.1282277,-0.015640244,0.16905665,-1.0379962},
{-0.8664769,0.2048318,-0.4052508,-0.20671798,-1.2467588,0.40893188,0.1067451,0.23047768,-0.6880839,-0.30794594,-0.3424965,-0.18691634,-0.1999231,-0.41839346,-0.70556396,0.0369191},
{0.015418979,-0.4808951,-0.015659904,-0.015079103,0.0508637,-0.07958702,-1.3165262,-1.1237853,0.0012506841,0.080936424,0.068546794,0.00010628652,-0.053011753,0.013044454,0.0013508991,-1.0155872},
{0.2500305,0.57723546,0.22476782,0.09133559,-2.5938551,0.43580368,0.17120212,0.26203227,-1.4158034,-1.8008305,-0.3793406,-0.6438816,0.22889037,0.079928555,-1.5318844,0.210469},
{-1.5458428,-0.34148845,-1.5285221,-1.0486256,-2.4015913,0.08517414,0.07608325,0.121650666,-0.5111657,-0.49617907,-0.56964433,-0.08429064,-1.5463617,-1.5002582,-1.0642555,-0.007604682},
{-0.08581636,-1.0711046,-0.014132059,-0.027121138,0.093386136,-0.4893467,-1.5806556,-1.9226577,0.25311217,-0.016057499,0.01347205,0.5743217,0.08925478,-0.04389257,0.020144014,-1.3575675},
{0.24212837,-0.11031586,0.14297286,0.26384908,0.08228132,-0.14901799,0.24120325,-0.05867885,0.20785236,0.069250464,0.11474961,-0.0751587,-0.17722672,0.18774313,0.017898023,-0.23294334},
{0.02694241,-0.3812703,0.15271755,-0.19367626,0.073503606,-0.113106124,-1.694023,-0.8300961,0.034915887,-0.014226889,0.071988754,-0.012619129,0.058601152,0.058315508,0.13340384,-0.9775967},
{-0.19262592,-0.60078955,-0.117573224,-0.1975144,0.39879763,-0.7628622,-0.8533729,-0.579057,0.67008346,0.54966563,0.39051476,0.86920434,0.25030947,-0.0521141,0.8088718,-0.41717967},
{0.042922545,-0.60107267,-0.07812475,-0.16705269,-0.18355791,-0.20450485,-1.5273082,-1.003381,0.009156936,0.0038812854,0.12310865,0.071216814,-0.14429462,-0.041853018,0.034932557,-1.2275413},
{-0.0922704,0.059669767,-0.2987457,-1.0348562,-1.1708875,0.08428355,0.0030267488,-0.0057440014,-0.55856687,-0.046318717,-0.04989371,-0.052389484,-0.09493424,-0.6421182,-0.43569762,0.023678161},
{0.04573529,-0.5895057,-0.054466847,-0.07153201,0.16882606,-0.4250263,-0.35378525,-0.4771301,0.42973346,0.1738977,0.8385418,0.7006882,0.0074302107,-0.08145128,0.3434768,-0.5908438},
{0.35682708,0.23879878,0.32309827,0.24147852,0.46220115,0.20901184,0.15522183,0.14811893,-1.4327435,-0.22849736,-0.44255918,-0.60647374,0.27283442,0.23997983,-0.6321187,0.10139346},
{0.024999883,0.03120223,-5.918482e-06,-0.0069421064,0.014718289,0.0049853814,-0.75958484,-0.83910054,0.010942089,-0.031250387,0.016737062,0.0014437349,0.0051397057,-0.0017173076,0.04939459,-0.7538011},
{-0.7994801,0.046641145,-1.1882923,-1.8584718,-1.0977477,0.06892884,0.02701901,0.014419122,-0.05971493,-0.20950775,-0.054731853,-0.06904001,-1.0351126,-1.1293157,-0.15487513,0.038433906},
{-0.013431266,-0.3375087,-0.03162126,-0.03409047,0.02434001,-0.11349157,-1.8670776,-0.6398169,0.009332644,0.054722633,0.035508152,-0.035415772,0.07027296,-0.028320804,0.007625089,-0.9672867},
{-0.27638346,0.6761389,-0.60863847,-0.72317463,-1.1369361,0.68298525,0.26873034,0.40358877,-0.3149411,-0.46724626,-0.55272317,-0.30659482,-0.38501868,-0.45257294,-0.58069086,0.15808456},
{-0.22265176,-0.20519382,0.055883378,-0.17590433,-0.0016741157,-0.18207224,0.22954518,-0.16646661,-0.15814349,-0.22902533,0.11334574,0.0916076,-0.14751853,-0.24203528,0.045636177,-0.18763153},
{-0.16319527,0.015556818,-0.6415279,-0.88002956,-0.66062415,0.0018875607,0.0012936727,-0.032501858,0.0025605003,-0.0066856705,-0.09918874,-0.024998639,-0.011846484,-0.92629576,-0.0426088,-0.007739263},
{-1.2289139,-0.025431512,-1.2683041,-1.1499816,-1.1076686,0.015544198,0.089211784,0.03223801,-0.07202869,-0.34718588,0.01182321,-0.053610664,-1.0300384,-0.9164596,-0.16116174,-0.033144057},
{0.09157608,-0.81130266,-0.0389591,-0.06288853,0.13824728,-0.09230642,-0.26946658,-0.2865222,0.07167314,0.14325091,0.566635,0.13467497,0.02302106,-0.049394112,0.51127774,-0.37689197},
{-0.15569988,-0.24432573,-0.010688573,-0.21426101,-0.04953462,0.10737792,0.07590756,-0.051071957,0.05063513,-0.16793813,0.23857594,0.20270965,-0.21067,0.17085284,0.18622041,0.030470252},
{0.12787527,0.2314831,0.038571954,-0.18494692,0.18539038,0.23357147,-0.2510825,-0.1930443,0.011097312,0.1777218,0.20299003,-0.17412776,0.23080337,0.1305593,0.23757279,-0.18482319},
{-1.3898041,0.19433308,-1.0877359,-1.5217712,-1.4155345,0.13721974,0.23194928,0.11321967,-0.16515411,-1.113016,-0.072101034,-0.13600865,-0.7851141,-0.9624787,-0.44658557,0.08679653},
{-0.18052138,0.038690448,-0.25011092,0.22475815,0.2395184,-0.11438593,-0.26196295,-0.24219349,0.14486694,0.2371121,0.097047925,0.2058455,0.044140905,0.2069847,0.27261943,-0.10915415},
{0.08850178,-0.06519667,-0.2555986,-0.38491157,0.7016611,-0.24096753,-0.081895135,-0.20572391,0.4556271,0.31548584,0.31495142,1.022034,0.7836418,0.14488614,0.053034563,0.20265591},
{-0.00017283582,-0.651789,-0.043437865,-0.028293416,0.074585974,-0.29236993,-1.8398626,-1.2575114,0.015306339,0.043766107,0.021637453,0.18274538,0.0778714,-0.025458839,0.09545548,-1.5532787},
{-0.023427451,-0.44776872,-0.2645297,-0.5831622,-0.18324491,-0.2148569,-0.8436262,-0.39065546,0.047848523,0.12183905,-0.039568573,0.08258435,-0.25568283,-0.25673074,-0.0020645903,-0.35204747},
{0.2154791,-0.020046297,-0.1623278,0.03137649,-0.23416337,0.1705687,0.18437138,-0.010522387,-0.016563674,-0.25378513,-0.1660778,0.11384043,0.15497895,0.11952595,0.1328559,-0.18701108},
{-0.18070307,-0.11151179,-0.8195927,-1.360169,-0.4132074,-0.0219522,-0.65672576,-0.15536985,-0.0035715,0.048680507,-0.005672585,-0.004859257,-0.47852018,-0.5739039,-0.024905546,-0.32062823},
{-1.3822725,0.14908472,-1.2892945,-1.7080317,-1.4080604,0.0749954,0.31029364,0.19280548,-0.13002564,-0.7025386,0.02335645,-0.17304221,-0.87056285,-1.0675694,-0.4870532,0.04318556},
{-0.031160872,-0.26910248,-0.11787087,-0.45448887,-1.805482,-0.069919966,0.23487341,0.19899353,-0.7733007,-0.76417375,0.5124765,0.34394935,0.17869267,-0.0075319335,-0.46389285,0.04227994},
{0.023681222,-0.34152308,-0.06114355,-0.069674574,0.18255498,-0.09169875,-0.5274327,-0.8336295,0.47678763,0.36969274,0.45945516,0.54844046,0.02684096,-0.04241616,0.43060842,-0.6848964},
{-0.13553452,0.047490504,-0.3401903,-0.49095926,-0.886337,0.0048973537,-0.0071408246,-0.008602128,-0.038200893,-0.08357456,-0.07671089,-0.022342673,-0.15995237,-0.56597275,-0.074272566,-0.007019147},
{0.08433492,-1.2830852,-0.1485592,-0.14949284,-0.31936267,-1.2794126,-0.72450924,-1.1772497,-0.29187045,0.02630615,-0.096855134,0.63220614,-0.020612583,0.014818091,-0.04631593,-1.4308805}
};
float b2[16]={
0.043749765,0.05890925,0.0713482,0.08127666,0.32646027,0.019713784,0.050693616,0.0718165,0.013766436,0.02422155,0.016347943,0.012494813,0.000721744,0.07276003,0.014522712,0.13183218
};

float w3[16][8]={
{-1.3829741,-0.35704243,0.31368202,0.4240233,0.23867819,-1.647651,-0.14356318,0.054790534},
{0.022213366,-0.119050846,0.1566803,-1.6811811,-0.36689702,0.02741945,-0.26998472,-0.44878998},
{-1.7968715,-0.10537807,-0.52191615,0.13575175,0.7006152,-0.71907854,-0.053595603,0.70874774},
{-0.48132864,-0.034363404,0.077408694,0.025755754,0.7938815,-0.25473624,0.19853975,0.96646523},
{-0.5606313,-0.8462396,-0.27226835,-0.52836305,-0.37239212,-0.22949135,-0.09982836,0.75329214},
{-0.053138822,-0.11460693,-0.34328553,-1.1865242,0.21125205,0.04012773,-0.15465751,-0.22931919},
{-0.2209376,-1.1079586,-0.33243737,-1.874833,-0.0085705565,0.31382447,-1.3317207,-2.2050474},
{-0.110436745,-0.42007977,-0.30309847,-2.3687572,0.42947644,0.09768627,-0.66551024,-1.0252358},
{-0.19998501,-0.045443807,0.071110174,0.10397777,-1.8058168,-0.8658334,-3.5170112,-0.0032415374},
{-0.7200128,0.115369424,0.28358185,0.031676706,-0.35798934,-1.4147213,-1.1175427,-0.006742564},
{-0.103862755,-0.010274441,-0.22137785,0.05015736,-0.69613355,-0.640772,-3.147372,-0.0036327369},
{-0.0337486,0.02892085,-0.15433638,0.028453974,-0.85633975,-0.22715399,-1.0761201,-0.002296082},
{-0.96419746,-0.095599346,-0.46974766,0.30812177,0.35810295,-0.9017609,-0.57624817,0.011659503},
{-1.8206174,-0.28875017,0.28474993,0.4585342,0.49018273,-0.48668477,-0.16206363,0.26878554},
{-0.39502758,0.60863113,-0.5793021,-0.33058453,-0.44471654,-2.1839025,-1.3920882,-0.003620518},
{0.66284996,0.1873594,-0.12009986,-1.3527058,0.11546293,-0.9008326,0.8973794,0.35180646}
};
float b3[8]={
0.25681737,0.18223816,-0.20841788,0.1260392,-0.0024979024,0.11491408,0.02087154,0.21526422
};

float w4[8][1]={
{-0.8944616},
{0.76595795},
{-0.6631517},
{1.1102318},
{-0.13383842},
{-0.674448},
{-1.7060552},
{0.9679749}
};
float b4[1]={
0.32381567
};
void Transform()
{
    Input[0]=(Input[0]-0.0)/(782.0-0.0);
    Input[1]=(Input[1]-0.0)/(175.0-0.0);
    Input[2]=(Input[2]-0.0)/(1023.0-0.0);
    Input[3]=(Input[3]-41.0)/(659.0-41.0);
    Input[4]=(Input[4]-30.0)/(737.0-30.0);
    Input[5]=(Input[5]-0.0)/(1006.0-0.0);
    Input[6]=(Input[6]-0.0)/(142.0-0.0);
    Input[7]=(Input[7]-13.0)/(583.0-13.0);

}







double Softmax(double x)
{
    if (x<=0) x=0;
    return x;
}


double Relu(double x)
{
    if (x<=0) x=0;
    return x;
}

void Forward()
{
    /*******第一层输出********/
    for (int i=0;i<Dense1_Node;i++)
    {
        for (int j=0;j<Input_Node;j++)
        {
            Dense1[i] += w1[j][i]*Input[j];
        }
    }
    for (int i=0;i<Dense1_Node;i++)
    {
        Dense1[i]+= b1[i];
        Dense1[i] = Relu(Dense1[i]);
    }
    /******第二层***********/
    for (int i=0;i<Dense2_Node;i++)
    {
        for (int j=0;j<Dense1_Node;j++)
        {
            Dense2[i] += w2[j][i]*Dense1[j];
        }
    }
    for (int i=0;i<Dense2_Node;i++)
    {
        Dense2[i]+= b2[i];
        Dense2[i] = Relu(Dense2[i]);
    }
    /******第三层***********/
    for (int i=0;i<Dense3_Node;i++)
    {
        for (int j=0;j<Dense2_Node;j++)
        {
            Dense3[i] += w3[j][i]*Dense2[j];
        }
    }
    for (int i=0;i<Dense3_Node;i++)
    {
        Dense3[i]+= b3[i];
        Dense3[i] = Relu(Dense3[i]);
    }
    /******第四层***********/
    for (int i=0;i<Dense4_Node;i++)
    {
        for (int j=0;j<Dense3_Node;j++)
        {
            Dense4[i] += w4[j][i]*Dense3[j];
        }
    }
    for (int i=0;i<Dense4_Node;i++)
    {
        Dense4[i]+= b4[i];
        Dense4[i] = Relu(Dense4[i]);
    }


    Output=Dense4[0];

}


void Inverse_Transform()
{
    Output=Output*(630-370) + 370;
}
void Output_Limit()
{
    if (Output>630) Output=630;
    else if (Output<370) Output=370;
//    Output=0;
}

void Dense_Init()
{
    Output=0;
    memset(Dense1,0,sizeof(Dense1));
    memset(Dense2,0,sizeof(Dense2));
    memset(Dense3,0,sizeof(Dense3));
    memset(Dense4,0,sizeof(Dense4));

}

void Run_Model_Linear()
{

    Input[0]=ad.left;
    Input[1]=ad.shu_left;
    Input[2]=ad.xie_left;
    Input[3]=ad.mid_left;
    Input[4]=ad.mid_right;
    Input[5]=ad.xie_right;
    Input[6]=ad.shu_right;
    Input[7]=ad.right;

    Dense_Init();
    Transform();
    Forward();
    Inverse_Transform();
    Output_Limit();

    steer.duty=Output;



}
